#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f check_domain.sh -o domain_status 
#endif

static  char data [] = 
#define      msg2_z	19
#define      msg2	((&data[4]))
	"\160\314\246\127\077\105\242\203\253\122\305\277\345\106\334\143"
	"\202\322\251\207\113\373\101\231\271"
#define      tst1_z	22
#define      tst1	((&data[29]))
	"\167\347\154\303\073\370\136\317\326\250\037\250\036\032\223\364"
	"\062\227\013\365\227\102\277\143\101\026\126\152\062"
#define      pswd_z	256
#define      pswd	((&data[60]))
	"\266\166\201\201\020\337\234\161\032\000\304\047\041\255\151\353"
	"\274\224\344\132\011\045\077\067\333\171\171\375\047\300\125\246"
	"\250\175\076\046\321\332\227\354\333\133\024\375\011\175\350\305"
	"\022\315\037\034\363\137\123\316\330\315\314\000\215\042\246\066"
	"\237\344\134\160\277\364\135\233\117\161\230\131\357\201\037\002"
	"\116\077\036\101\236\162\020\166\077\334\166\315\377\035\003\236"
	"\002\137\017\301\123\154\134\243\336\365\375\315\166\034\317\304"
	"\134\356\006\372\140\026\161\237\363\347\154\363\005\157\221\007"
	"\317\241\311\043\016\045\307\354\033\304\272\221\341\212\126\075"
	"\170\135\070\330\163\251\167\147\221\344\132\226\123\354\235\042"
	"\216\147\105\234\215\015\211\250\321\103\071\263\316\220\361\107"
	"\355\051\040\141\322\227\311\144\174\044\372\317\020\230\362\236"
	"\377\070\073\214\105\304\065\026\010\157\312\326\377\273\035\354"
	"\345\075\116\270\325\027\034\121\073\027\041\114\257\023\352\257"
	"\113\045\074\220\352\161\247\362\340\162\310\340\055\346\315\022"
	"\044\033\313\372\062\347\114\156\376\156\272\256\201\245\135\315"
	"\313\232\136\265\013\006\067\034\345\337\010\136\117\325\005\247"
	"\156\276\043\043\103\232\013\257\136\141\031\220\162\062\104\051"
	"\251\305\253\272\245\342\326\212\301\337\351\021\264\356\270\043"
	"\255\334\107"
#define      chk2_z	19
#define      chk2	((&data[363]))
	"\237\326\005\026\122\243\310\117\321\230\117\131\224\071\030\060"
	"\373\075\366\155\102\264"
#define      rlax_z	1
#define      rlax	((&data[383]))
	"\123"
#define      tst2_z	19
#define      tst2	((&data[387]))
	"\225\161\374\210\220\312\327\343\030\166\123\113\176\021\072\167"
	"\013\377\242\054\362\256\117"
#define      msg1_z	65
#define      msg1	((&data[421]))
	"\241\241\005\213\262\272\171\153\335\047\107\045\027\277\002\067"
	"\026\312\300\102\074\074\267\014\274\003\130\345\050\076\354\136"
	"\063\373\260\006\210\132\003\100\203\063\243\130\370\306\266\015"
	"\271\154\051\021\256\270\377\245\300\365\047\042\167\076\156\144"
	"\113\214\261\206\126\136\244\065\007\316\204\331\350\037\262\170"
	"\267"
#define      chk1_z	22
#define      chk1	((&data[489]))
	"\375\330\035\211\045\012\224\350\015\071\060\213\240\104\111\236"
	"\263\011\017\150\267\375\122\125\135"
#define      opts_z	1
#define      opts	((&data[513]))
	"\152"
#define      date_z	1
#define      date	((&data[514]))
	"\266"
#define      shll_z	10
#define      shll	((&data[516]))
	"\323\170\253\326\145\042\115\213\312\241\321\043"
#define      lsto_z	1
#define      lsto	((&data[527]))
	"\025"
#define      inlo_z	3
#define      inlo	((&data[528]))
	"\010\153\146"
#define      xecc_z	15
#define      xecc	((&data[534]))
	"\055\027\111\272\233\116\030\341\364\176\235\062\274\066\344\051"
	"\063\335\246\316"
#define      text_z	2928
#define      text	((&data[1156]))
	"\334\050\235\205\317\221\240\162\325\321\364\077\245\030\257\004"
	"\357\331\334\060\341\334\272\017\364\003\265\302\342\211\002\276"
	"\261\240\103\200\062\343\363\007\265\350\106\132\000\365\136\357"
	"\317\073\040\261\030\333\301\014\336\166\317\301\377\322\177\261"
	"\163\303\062\245\247\045\254\134\015\362\267\016\350\026\375\270"
	"\122\036\151\153\371\052\167\330\241\107\232\241\031\032\122\215"
	"\335\204\062\205\251\336\341\267\321\231\305\272\257\302\162\002"
	"\341\334\155\333\006\345\263\250\054\116\111\106\150\234\323\105"
	"\040\005\312\312\344\254\201\265\105\106\157\365\011\342\367\353"
	"\276\144\306\305\111\172\155\166\310\267\274\060\123\220\165\163"
	"\226\100\076\172\355\277\057\062\006\237\050\020\201\040\373\077"
	"\204\301\005\316\073\162\105\003\051\002\064\174\222\252\360\050"
	"\352\057\243\327\357\322\012\365\162\062\005\363\123\000\063\330"
	"\302\070\246\375\252\354\001\324\356\065\121\200\337\102\251\312"
	"\161\114\242\140\037\254\126\221\337\133\204\062\134\270\012\036"
	"\360\261\034\233\235\036\157\213\123\301\014\063\003\266\376\165"
	"\003\240\325\042\115\053\264\054\207\071\137\344\361\152\002\341"
	"\034\037\174\271\075\354\105\221\256\122\305\262\010\303\047\014"
	"\143\375\056\261\051\342\335\261\034\075\225\015\250\230\356\304"
	"\267\153\175\365\130\303\207\006\026\114\270\036\017\340\053\163"
	"\336\131\044\007\074\002\270\130\100\115\146\350\346\124\254\236"
	"\300\052\223\030\356\032\037\004\147\330\043\167\270\116\353\226"
	"\250\017\236\344\022\127\075\123\245\243\073\213\370\350\051\271"
	"\022\275\321\000\327\361\004\076\311\047\265\202\165\240\031\036"
	"\260\267\003\303\016\100\026\263\344\122\077\335\072\150\226\115"
	"\045\150\116\375\132\122\074\043\172\362\246\360\223\300\016\104"
	"\167\021\010\206\122\036\072\067\161\172\025\254\342\254\371\010"
	"\025\107\006\157\232\102\223\025\064\071\006\310\371\025\014\161"
	"\046\024\370\171\063\063\261\244\255\306\121\220\162\112\231\207"
	"\222\237\367\054\342\212\102\027\303\110\337\275\135\353\057\204"
	"\000\047\375\063\133\257\330\010\165\052\231\350\164\062\160\007"
	"\321\147\064\263\361\166\312\265\277\252\163\034\225\242\241\226"
	"\312\237\312\045\116\243\056\304\315\307\254\101\372\034\111\314"
	"\204\175\177\166\363\112\053\263\364\237\317\212\102\161\040\014"
	"\020\352\062\136\216\141\042\133\051\317\235\043\354\346\357\160"
	"\143\157\347\127\271\022\012\256\262\332\071\364\113\131\001\133"
	"\104\063\272\322\225\335\056\276\254\313\342\231\261\321\011\024"
	"\101\361\153\373\003\166\251\266\120\342\252\233\074\265\062\176"
	"\314\263\327\347\206\345\020\275\131\326\346\266\254\312\116\272"
	"\004\067\323\303\311\140\076\076\275\037\365\125\305\367\344\355"
	"\053\111\030\132\134\111\226\202\261\176\226\341\213\174\336\034"
	"\373\027\107\262\322\316\062\002\233\371\264\103\300\111\324\034"
	"\211\304\004\113\002\324\063\010\052\142\135\220\243\254\224\172"
	"\067\174\130\026\062\341\130\340\126\227\016\270\010\031\370\230"
	"\326\016\045\135\000\130\133\235\122\135\076\260\030\263\326\025"
	"\004\371\316\256\010\221\164\107\310\267\234\150\001\024\235\227"
	"\302\132\330\115\154\313\377\056\370\375\040\326\176\272\326\221"
	"\207\220\044\351\142\366\336\010\133\372\341\236\234\066\370\210"
	"\102\164\066\374\215\211\101\204\350\120\324\254\207\024\142\257"
	"\237\353\121\002\043\115\205\124\175\302\006\375\151\050\120\256"
	"\352\233\302\330\015\106\010\366\111\204\075\302\315\052\156\365"
	"\146\324\236\102\376\025\024\322\027\231\203\363\275\155\375\334"
	"\006\257\004\077\075\007\021\321\352\067\116\376\146\105\003\173"
	"\113\006\072\245\177\377\203\136\110\040\250\257\230\027\023\332"
	"\234\104\227\070\267\215\261\125\321\242\116\175\150\373\075\352"
	"\116\125\220\107\124\326\340\144\301\362\116\355\012\302\073\342"
	"\200\101\341\313\374\310\135\136\012\041\167\312\067\007\026\136"
	"\013\067\053\260\000\011\160\066\250\372\041\042\053\244\170\001"
	"\276\002\216\264\265\205\364\301\146\015\274\012\344\001\016\145"
	"\327\314\372\341\257\145\074\145\064\251\221\106\033\332\264\262"
	"\125\176\022\274\303\041\067\171\040\240\111\302\351\374\001\124"
	"\175\021\001\323\016\142\276\176\221\315\120\327\045\364\174\007"
	"\131\342\320\205\021\114\050\251\004\030\173\266\042\071\175\242"
	"\376\215\316\156\345\032\321\203\241\122\375\233\260\226\210\173"
	"\156\117\257\000\037\065\017\141\305\154\177\301\365\126\064\107"
	"\336\210\140\073\064\044\356\212\051\225\221\176\325\327\150\320"
	"\017\326\136\030\336\022\174\125\106\171\262\027\147\064\114\332"
	"\311\145\166\026\211\256\347\253\076\015\116\046\007\020\376\222"
	"\206\064\276\045\006\375\074\231\130\001\341\003\155\253\141\264"
	"\124\230\270\304\333\060\013\353\141\053\202\205\354\015\066\346"
	"\256\001\200\302\247\017\154\234\210\247\201\376\007\311\055\246"
	"\247\135\357\272\246\220\143\076\004\212\060\176\341\243\127\235"
	"\072\101\372\305\326\055\062\153\232\121\070\161\210\021\024\371"
	"\114\056\324\066\121\242\332\120\302\120\261\024\027\370\232\146"
	"\314\176\110\350\044\320\344\266\024\324\372\103\164\346\062\145"
	"\030\031\042\301\203\127\235\125\213\053\307\102\376\041\173\347"
	"\040\301\223\262\107\002\044\252\227\017\353\245\154\152\325\245"
	"\326\051\034\253\014\162\240\377\375\155\342\117\117\205\231\147"
	"\337\334\217\147\261\100\130\012\015\266\330\075\117\156\227\102"
	"\232\242\016\271\055\033\214\224\002\351\105\277\237\340\172\034"
	"\210\203\354\061\325\072\153\321\012\256\313\251\020\013\253\216"
	"\102\070\037\122\123\153\273\170\103\106\267\241\354\041\367\236"
	"\037\022\052\232\075\252\271\140\124\033\324\370\101\370\304\122"
	"\144\335\360\301\353\001\072\320\152\074\117\335\050\134\304\337"
	"\000\170\341\366\011\046\332\250\366\275\323\235\177\322\111\260"
	"\340\341\117\074\123\120\331\063\072\310\101\366\035\063\251\153"
	"\164\201\201\067\357\001\107\102\213\237\234\030\210\323\352\240"
	"\256\001\142\101\232\316\053\024\320\124\054\230\133\342\124\232"
	"\237\140\162\310\244\072\061\023\174\107\112\043\017\344\312\364"
	"\115\203\243\113\107\165\227\001\366\161\311\322\001\250\322\331"
	"\277\040\113\321\074\355\171\325\201\250\066\323\217\002\366\062"
	"\075\143\114\361\067\213\365\153\140\300\160\355\100\125\116\251"
	"\177\300\231\237\152\115\236\162\131\272\260\232\073\156\246\224"
	"\077\152\253\013\052\371\245\366\275\313\210\006\316\267\020\234"
	"\306\303\327\073\053\122\033\172\347\234\152\041\124\000\170\107"
	"\277\333\100\122\222\272\206\241\374\311\037\304\345\123\241\141"
	"\164\373\350\075\172\051\157\163\070\246\364\164\324\053\071\173"
	"\131\317\351\060\154\274\127\350\010\365\331\004\261\300\244\324"
	"\347\055\336\352\254\035\226\203\010\030\263\115\352\364\111\076"
	"\367\340\372\041\154\244\247\146\052\220\047\242\011\356\141\107"
	"\015\025\343\354\017\211\171\317\100\216\360\226\131\031\322\134"
	"\314\006\252\267\304\235\360\350\273\024\262\215\325\070\122\320"
	"\345\263\267\111\200\337\177\134\101\030\151\141\232\163\207\254"
	"\357\301\316\312\275\222\024\043\363\144\033\275\075\271\240\114"
	"\271\150\232\124\300\357\226\272\261\276\321\115\301\346\007\004"
	"\116\354\220\345\163\360\363\071\123\115\205\141\124\063\057\133"
	"\004\012\232\303\154\227\010\032\203\140\277\173\215\101\316\300"
	"\226\060\301\313\162\006\274\125\345\257\240\123\354\364\045\306"
	"\243\110\102\141\156\165\144\254\105\143\073\264\062\046\315\254"
	"\243\254\041\144\013\371\044\214\127\055\165\151\057\332\154\150"
	"\026\372\342\167\245\221\247\214\311\120\056\161\247\331\351\356"
	"\042\001\212\302\100\021\335\130\340\361\226\232\174\271\017\035"
	"\174\314\012\226\344\064\143\360\160\104\112\150\022\110\027\257"
	"\325\375\247\370\140\153\122\164\040\363\032\123\267\200\076\346"
	"\162\317\331\046\345\071\074\252\207\263\210\123\161\325\365\274"
	"\320\117\275\151\057\042\006\027\071\126\132\026\025\117\242\144"
	"\304\025\352\105\305\161\166\142\013\113\045\315\064\226\263\253"
	"\203\016\321\305\031\366\316\156\176\340\314\245\374\011\220\260"
	"\021\245\037\305\236\226\114\073\122\362\174\357\107\057\311\012"
	"\273\123\212\147\153\271\367\356\101\063\301\331\157\343\260\334"
	"\232\203\016\066\145\333\242\205\034\130\067\145\212\164\327\314"
	"\342\233\360\362\347\141\061\337\025\212\323\141\005\206\171\373"
	"\033\126\330\136\136\166\056\254\240\224\267\210\000\353\357\043"
	"\224\006\352\173\056\204\213\176\105\226\227\254\007\244\015\356"
	"\062\006\364\141\014\371\032\376\226\337\175\105\347\104\247\015"
	"\132\300\212\106\176\143\105\127\313\011\044\073\326\363\372\043"
	"\210\053\251\355\306\342\204\303\351\052\377\025\174\374\226\311"
	"\257\101\211\361\372\120\007\221\314\327\063\243\371\036\022\034"
	"\325\207\205\117\217\247\266\113\010\315\047\254\105\150\272\257"
	"\303\331\310\362\232\337\213\243\052\021\324\236\275\153\157\114"
	"\031\132\361\175\304\330\321\124\240\275\304\144\360\327\264\016"
	"\227\234\211\365\212\264\362\104\117\145\243\337\345\027\065\236"
	"\072\117\206\200\346\025\042\025\363\066\312\077\141\351\155\376"
	"\060\070\054\025\346\347\151\007\103\131\021\247\026\061\264\240"
	"\346\343\252\217\337\120\335\321\152\232\114\231\117\130\335\306"
	"\111\013\034\152\060\057\133\015\102\136\105\337\307\300\322\113"
	"\340\164\237\222\176\203\326\332\055\065\040\354\313\372\305\317"
	"\031\005\247\352\205\051\032\323\061\142\243\073\271\345\332\253"
	"\233\177\231\341\103\005\130\240\362\302\001\100\164\374\320\024"
	"\337\226\275\131\262\132\230\375\146\241\046\034\040\141\011\200"
	"\050\331\224\112\137\241\224\007\316\017\217\014\035\104\072\142"
	"\376\122\044\376\075\067\100\224\337\227\226\336\275\003\307\063"
	"\120\146\076\037\144\216\305\104\265\067\111\012\177\207\225\301"
	"\247\035\260\131\303\052\116\012\240\212\343\261\226\035\106\072"
	"\102\077\024\071\166\115\304\333\123\363\114\361\200\034\033\114"
	"\312\141\065\076\176\374\055\255\136\015\343\263\244\246\224\375"
	"\360\314\036\361\110\026\171\024\337\217\137\002\313\011\144\163"
	"\074\024\033\306\162\330\171\113\201\042\237\125\360\041\137\165"
	"\326\204\342\044\264\363\342\364\016\150\121\052\021\365\023\066"
	"\074\302\215\105\215\355\145\341\372\366\351\263\312\054\056\222"
	"\040\031\115\320\260\205\016\205\132\135\145\163\330\127\257\057"
	"\075\372\235\214\152\352\133\005\170\015\102\275\143\306\246\321"
	"\220\053\030\314\325\106\265\260\153\354\375\304\050\132\031\314"
	"\041\047\031\107\254\151\022\211\020\274\017\276\265\003\141\134"
	"\310\077\274\357\205\055\052\001\052\000\067\034\277\152\127\267"
	"\137\340\377\040\363\271\155\311\027\126\120\315\102\304\240\117"
	"\105\102\230\252\112\201\020\247\300\024\355\140\342\243\130\324"
	"\041\150\056\245\146\201\140\050\345\102\177\330\262\312\074\271"
	"\352\372\373\041\277\300\046\302\320\305\241\311\011\135\302\054"
	"\350\172\222\214\362\206\047\261\206\010\122\132\045\272\016\056"
	"\244\271\242\325\217\166\007\252\035\226\232\233\030\147\037\225"
	"\342\230\074\006\357\136\163\374\205\160\362\262\244\333\256\221"
	"\226\242\031\011\320\256\201\215\320\046\012\266\251\241\222\016"
	"\343\013\213\246\112\107\070\317\104\007\122\064\113\321\337\177"
	"\333\174\057\212\371\315\106\251\054\264\242\343\305\023\114\216"
	"\143\324\310\006\140\240\116\111\113\313\071\140\201\332\244\210"
	"\355\301\100\202\234\302\020\162\060\110\353\213\313\266\172\015"
	"\347\004\016\207\014\023\071\221\312\000\271\363\002\163\275\073"
	"\170\254\332\104\234\317\303\250\216\040\240\265\221\075\336\350"
	"\013\100\376\056\251\210\050\147\257\150\351\137\271\040\077\255"
	"\061\077\213\265\255\263\224\201\005\323\012\050\151\310\371\203"
	"\241\132\335\104\341\170\154\262\130\377\200\107\212\371\207\216"
	"\111\207\351\160\270\043\103\156\121\204\277\342\233\004\002\113"
	"\335\040\075\037\246\221\153\355\134\215\346\170\245\102\126\376"
	"\233\170\242\144\336\236\110\156\060\232\303\235\262\050\153\272"
	"\314\026\223\104\141\264\325\341\250\222\216\165\062\223\060\302"
	"\026\307\024\313\054\035\313\330\270\124\142\344\012\175\326\361"
	"\304\243\337\247\051\161\145\136\002\133\341\024\114\153\142\105"
	"\075\073\056\116\225\327\237\317\322\257\043\375\147\006\315\130"
	"\051\345\012\027\045\136\324\153\024\114\023\152\321\222\120\261"
	"\100\356\070\313\217\145\326\334\365\135\251\274\220\377\151\031"
	"\213\347\333\221\364\333\172\214\260\232\264\163\110\171\160\220"
	"\324\006\241\075\155\262\073\357\363\204\331\264\000\024\224\312"
	"\010\074\320\371\311\060\331\213\225\365\057\206\135\275\050\177"
	"\267\135\121\273\366\052\211\205\344\351\354\120\040\321\354\335"
	"\300\061\136\035\377\043\243\076\333\054\362\220\230\264\333\072"
	"\076\130\331\034\030\307\024\374\235\306\011\143\371\241\312\010"
	"\301\152\331\325\161\351\052\243\074\234\230\170\121\375\066\172"
	"\311\376\004\347\205\225\016\032\174\120\366\220\360\055\124\242"
	"\300\246\126\107\066\336\267\012\235\043\113\162\044\125\120\173"
	"\317\007\016\003\024\372\367\031\115\061\365\373\227\322\253\113"
	"\243\246\142\113\040\257\052\272\275\233\124\320\111\062\017\371"
	"\013\236\010\036\370\071\145\334\327\220\347\355\356\106\054\352"
	"\120\363\365\024\376\057\324\313\075\047\324\236\205\275\000\013"
	"\051\113\122\221\032\340\020\347\113\313\041\167\157\301\137\205"
	"\253\335\002\230\036\257\376\255\071\145\213\061\350\212\267\242"
	"\271\340\231\116\023\171\056\002\214\342\277\250\153\065\220\152"
	"\205\322\340\350\050\033\050\222\061\112\246\251\326\225\133\253"
	"\022\221\072\347\024\372\066\176\144\076\272\366\352\007\267\143"
	"\172\175\121\005\134\051\105\140\145\051\345\252\001\367\171\037"
	"\261\003\255\177\000\134\260\116\117\016\331\267\337\043\262\323"
	"\072\074\053\332\115\137\332\342\031\172\233\162\052\271\146\104"
	"\046\001\244\220\313\307\222\045\242\150\202\056\004\357\361\115"
	"\010\322\345\015\220\157\162\205\250\246\006\135\147\230\274\235"
	"\023\233\337\372\120\034\015\336\254\346\236\170\022\162\360\152"
	"\324\157\332\212\347\331\151\344\157\133\040\331\044\211\240\073"
	"\330\255\035\152\132\114\224\270\203\005\044\300\334\332\163\267"
	"\117\015\117\230\340\044\254\173\237\343\153\202\127\355\117\007"
	"\341\202\237\100\045\276\366\120\127\172\144\143\173\203\257\347"
	"\150\045\067\345\160\012\165\071\336\003\102\063\333\175\146\364"
	"\265\154\027\122\035\160\334\111\031\315\024\175\032\252\151\036"
	"\105\253\255\305\312\021\371\102\362\225\207\256\261\006\214\104"
	"\030\364\167\075\115\167\003\227\142\000\263\166\051\170\170\241"
	"\042\055\227\355\115\302\022\222\356\121\320\022\254\334\303\071"
	"\201\267\270\225\077\151\207\145\263\114\345\003\241\201\042\252"
	"\205\052\152\154\211\232\161\057\153\322\012\147\363\235\116\356"
	"\040\105\010\245\267\317\045\014\310\317\226\070\042\121\121\052"
	"\313\274\254\367\357\370\224\205\142\235\046\024\334\051\136\164"
	"\012\325\211\014\336\207\276\232\154\164\021\012\315\371\135\010"
	"\317\356\264\043\157\062\004\056\161\161\125\032\255\272\146\176"
	"\275\316\340\020\251\003\050\316\171\161\300\205\215\253\367\201"
	"\337\261\124\164\217\202\063\073\115\025\325\377\346\337\023\050"
	"\320\177\043\324\366\314\212\106\257\064\342\354\340\331\155\300"
	"\213\302\065\032\104\150\126\222\175\053\221\144\012\245\214\332"
	"\045\257\256\033\174\070\141\054\155\104\030\116\035\206\016\250"
	"\111\103\303\216\254\031\040\051\104\262\216\117\130\032\051\175"
	"\312\330\230\107\021\372\163\177\076\214\315\134\023\334\005\134"
	"\040\310\352\314\341\013\366\046\276\204\166\026\237\240\223\151"
	"\170\054\261\211\047\044\011\146\261\326\303\304\263\310\041\324"
	"\220\013\240\162\027\227\231\325\034\017\353\273\257\177\045\050"
	"\254\326\262\324\373\273\073\254\222\376\161\105\306\222\031\127"
	"\236\272\311\266\122\143\213\156\163\167\051\043\367\117\113\244"
	"\045\375\170\041"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
